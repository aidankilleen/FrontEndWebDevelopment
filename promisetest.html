<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>


</head>
<body>
    <h1>Promise Test</h1>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        let url = "http://localhost:3000/users";


        // fetch api

        fetch(url)
        .then(response => response.json())
        .then(users =>console.log(users));


        console.log("---------------------------");

        // do a post request using fetch instead of $.ajax

        let newUser = {
            name: "Fetch New", 
            email: "fetch.new@gmail.com", 
            active: false
        }

        const options = {
            method: "POST", 
            headers: {'Content-Type': 'application/json'}, 
            body: JSON.stringify(newUser)
        };

        fetch(url, options)
            .then(response => response.json())
            .then(createdUser => console.log(createdUser));
















/*

        $.ajax({
            url:url, 
            method: "GET"
        }).then(data=>console.log(data));





        function doAsynchronousOperation() {
            let p = new Promise(function(resolve, reject){
                // do something asynchronous
                setTimeout(()=>{
                    console.log("asynchronous operation complete");
                    if (Math.random() > 0.7) {
                        reject("something went wrong");
                    } else {
                        resolve();
                    }
                }, 2000);
            });
            return p;
        }

        doAsynchronousOperation()
            .then(()=>console.log("ok"))
            .catch(error=>console.log(error));

        doAsynchronousOperation();
*/


        // use a promise for callback 

        //setTimeout(function(){
        //    alert("1000 ms passed");
        //}, 1000);

/*
        let p = new Promise(function(resolve, reject) {

            // do something asynchronous
            setTimeout(()=>{
                console.log("asynchronous operation complete");

                if (Math.random() > 0.7) {
                    reject("something went wrong");

                } else {
                    resolve();
                }

            }, 2000);
        }).then(function() {
            console.log("then() handler called");
        }).catch(function(error) {
            console.log(`error: ${error}`);
        });

*/








        /*
        let p = new Promise(()=>
            ()=>{
                alert("everything ok");
            }, 
            (reason)=>{
                alert("something went wrong");
            }
        ));
        */










        // callback hell:
        /*
        $.ajax({
            url: url, 
            method: "GET", 

            success: function(data) {

                $.ajax({
                    url:url, 
                    method:"GET", 
                    success: function(data) {

                        $.ajax({

                            success: function() {


                            }
                        })
                    }
                })
            }
        }).then(function(data){
            console.log(data);
        });
        */


    </script>
</body>
</html>